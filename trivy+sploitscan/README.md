# Trivy Enricher
–ü—Ä–æ–µ–∫—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–æ–≥–∞—â–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π Trivy —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± —ç–∫—Å–ø–ª–æ–π—Ç–∞—Ö, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫–∞—Ö –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω —Å –ø–æ–º–æ—â—å—é DeepSeek AI

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
üìä –û–±–æ–≥–∞—â–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤ Trivy - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —ç–∫—Å–ø–ª–æ–π—Ç–∞—Ö, EPSS, CISA KEV, priority level    
‚ö° –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ - —É—Å–∫–æ—Ä–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ –º–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É CVE  
üíæ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ - –∏–∑–±–µ–∂–∞–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ SploitScan, –∫–∞–∫ —Å–ª–µ–¥—Å—Ç–≤–∏–µ, –±—É—Å—Ç –≤ —Å–∫–æ—Ä–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã  
üåê –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ HTML –æ—Ç—á–µ—Ç—ã - —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–æ–∏—Å–∫–æ–º


## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
Python 3.7+  
[Trivy](https://github.com/aquasecurity/trivy/releases)  
[SploitScan](https://github.com/xaitax/SploitScan)  
<sub><sup>***—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é sploitscan v.0.13.0 (v.0.14 –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —ç–∫—Å–ø–ª–æ–π—Ç–æ–≤ –≤–∫–ª—é—á–∞–µ—Ç –≤–º–µ—Å—Ç–æ –Ω–∏—Ö –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏)</sub></sup> 

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞
1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone <repository-url>
cd trivy\trivy-sploitscan
```
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç config.json –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫. –£–∫–∞–∂–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º–µ:
```json
{
  "sploitscan_path": "–ø—É—Ç—å/–∫/sploitscan.py",
  "scan_directory": "–ø–∞–ø–∫–∞/—Å/–æ—Ç—á–µ—Ç–∞–º–∏",
  "cache_directory": "–ø–∞–ø–∫–∞/–∫—ç—à–∞", 
  "max_workers": null,
  "timeout": 60
}
```
max_workers - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ–º—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø—Ä–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ SploitScan (—Ä–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –º–æ–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å)
timeout - –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö, –∑–∞ –∫–æ—Ç–æ—Ä–æ–µ SploitScan –¥–æ–ª–∂–µ–Ω –∑–∞–≤—Ä–µ—à–∏—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ. –ï—Å–ª–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –≤—Ä–µ–º—è - –ø—Ä–æ—Ü–µ—Å—Å –±—É–¥–µ—Ç –ø—Ä–µ—Ä–≤–∞–Ω.

3. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
```bash
python setup_config.py
```


## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
### 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ Trivy
–î–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞ –Ω—É–∂–µ–Ω –æ—Ç—á–µ—Ç —Ç—Ä–∏–≤–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json —Å—Ç—Ä–æ–≥–æ –≤ –∫–æ–¥–∏—Ä–æ–≤–∫–µ UTF-8
–û—Ç—á–µ—Ç –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥–æ–π (PowerShell):
```powershell
trivy image --format json your-image:tag | Set-Content -Encoding UTF8 .\scan.json
```
–û—Ç—á–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –∫ –∫–∞—Ç–∞–ª–æ–≥, —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ scan_directory

### 2. –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞:
–õ–æ–∫–∞–ª—å–Ω–æ –¥–ª—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
python main.py
```
Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
```powershell
docker run -v "${PWD}/input:/scan/trivy/trivy+sploitscan/input" -v "${PWD}:/output" theunclefyodor/tve:latest
```
<sub><sup>*–ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –æ—Ç—á–µ—Ç –Ω—É–∂–Ω–æ –ø–æ–ª–æ–∂–∏—Ç—å –≤ –ø–∞–ø–∫—É input.</sub></sup>  
<sub><sup>**–ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫–æ–Ω–µ—Ç–µ–π–Ω–µ—Ä–∞ —Å –∫–ª—é—á–æ–º --rm –∫—ç—à —Ä–µ—É–∑–ª—å—Ç–∞—Ç–æ–≤ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è SploitScan —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –Ω–µ –±—É–¥–µ—Ç (—Ç–µ—Ä—è–µ—Ç—Å—è –±—É—Å—Ç –≤ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤)</sub></sup>
<sub><sup>***–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è sploitscan v.0.13.0 (v.0.14 –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —ç–∫—Å–ø–ª–æ–π—Ç–æ–≤ –≤–∫–ª—é—á–∞–µ—Ç –≤–º–µ—Å—Ç–æ –Ω–∏—Ö –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏)</sub></sup>  

–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:
- –ù–∞–π–¥–µ—Ç –≤—Å–µ JSON –æ—Ç—á–µ—Ç—ã Trivy –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–∞–ø–∫–µ
- –ò–∑–≤–ª–µ—á–µ—Ç —Å–ø–∏—Å–æ–∫ CVE –∏–∑ –∫–∞–∂–¥–æ–≥–æ –æ—Ç—á–µ—Ç–∞
- –ü—Ä–æ—Å–∫–∞–Ω–∏—Ä—É–µ—Ç —É–Ω–∏–∞–ª—å–Ω—ã–µ CVE –≤ Sploitscan, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –≤ –∫—ç—à–µ. –ï—Å–ª–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å –æ—à–∏–±–∫–æ–π - –ø–æ–≤—Ç–æ—Ä–∏—Ç –µ–≥–æ –µ—â–µ 1 —Ä–∞–∑
- –ó–∞–∫—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è Sploitscan
- –û–±–æ–≥–∞—Ç–∏—Ç –≤—Ö–æ–¥–Ω–æ–π –æ—Ç—á–µ—Ç trivy —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è CVE –≤ SploitScan
- –°–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ HTML –æ—Ç—á–µ—Ç—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞

### 3. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å HTML –æ—Ç—á–µ—Ç–æ–≤
### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫:
- –ü–æ–∏—Å–∫ –ø–æ CVE ID –∏ –∏–º–µ–Ω–∏ –ø–∞–∫–µ—Ç–∞  
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É (A+, A, B, C, D)  
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ severity (Critical, High, Medium, Low, Unkmown)  
- –§–∏–ª—å—Ç—Ä –ø–æ EPSS score  
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ trivy vulnerability status (Fixed, Affected, Will not fix, Unkmown)  
- –ü–æ–∫–∞–∑ —Ç–æ–ª—å–∫–æ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã—Ö CISA KEV   
- –ü–æ–∫–∞–∑ —Ç–æ–ª—å–∫–æ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π —Å –ø—É–±–ª–∏—á–Ω—ã–º–∏ —ç–∫—Å–ø–ª–æ–π—Ç–∞–º–∏  

### –ë–ª–æ–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ CVE (—Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∫–æ–ª–∏—á–µ—Ç—Å–≤–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö CVE)
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —É—Ä–æ–≤–Ω—è–º –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏ (—Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∫–æ–ª–∏—á–µ—Ç—Å–≤–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö CVE)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π —Å —ç–∫—Å–ø–ª–æ–π—Ç–∞–º–∏

### –ö–∞—Ä—Ç–æ—á–∫–∏ 
–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:
- CVE-ID \ CVSS –≤–µ–∫—Ç–æ—Ä—ã –∏ –æ—Ü–µ–Ω–∫–∏ \ Severity Level \ Priority level \ EPSS –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏\ –°—Ç–∞—Ç—É—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏
- –ò–º—è —É—è–∑–≤–∏–º–æ–≥–æ –ø–∞–∫–µ—Ç–∞ \ –ï–≥–æ –≤–µ—Ä—Å–∏—è \ Fixed in
- –°—Ç–∞—Ç—É—Å CISA KEV
- –û–ø–∏—Å–∞–Ω–∏–µ —É–∑—è–≤–∏–º–æ—Å—Ç–∏
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —ç–∫—Å–ø–ª–æ–π—Ç–∞—Ö (GitHub, ExploitDB, Metasploit)
- –°—Å—ã–ª–∫–∏ –Ω–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã


## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
trivy-sploitscan/  
‚îú‚îÄ‚îÄ /logs                     # –ü–∞–ø–∫–∞, –≤ –∫–æ—Ç–æ—Ä—É—é –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–≥–∏ —Ä–∞–±–æ—Ç—ã Sploitscan (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç –ø—É—Ç–∏, —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤ scan_directory)  
‚îú‚îÄ‚îÄ main.py                   # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç  
‚îú‚îÄ‚îÄ config_manager.py         # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π  
‚îú‚îÄ‚îÄ setup_config.py           # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞  
‚îú‚îÄ‚îÄ enrichment_core.py        # –Ø–¥—Ä–æ –æ–±–æ–≥–∞—â–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤  
‚îú‚îÄ‚îÄ trivy_parser.py           # –ü–∞—Ä—Å–µ—Ä –æ—Ç—á–µ—Ç–æ–≤ Trivy  
‚îú‚îÄ‚îÄ sploitscan_runner.py      # –ó–∞–ø—É—Å–∫ SploitScan  
‚îú‚îÄ‚îÄ sploitscan_parser.py      # –ü–∞—Ä—Å–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ SploitScan  
‚îú‚îÄ‚îÄ parallel_processor.py     # –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞  
‚îú‚îÄ‚îÄ trivy_html_reporter.py    # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä HTML –æ—Ç—á–µ—Ç–æ–≤  
‚îú‚îÄ‚îÄ html_templates.py         # HTML —à–∞–±–ª–æ–Ω—ã  
‚îú‚îÄ‚îÄ config.json               # –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏  
‚îî‚îÄ‚îÄ README.md                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è  


## üîó –°—Å—ã–ª–∫–∏
SploitScan - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å–±–æ—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —ç–∫—Å–ø–ª–æ–π—Ç–∞—Ö (https://github.com/xaitax/SploitScan)  
Trivy - —Å–∫–∞–Ω–µ—Ä —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (https://github.com/aquasecurity/trivy)
